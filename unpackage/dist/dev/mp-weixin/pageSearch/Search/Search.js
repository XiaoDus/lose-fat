"use strict";const e=require("../../common/vendor.js");if(!Array){const g=e.resolveComponent("uni-icons"),l=e.resolveComponent("uni-easyinput"),f=e.resolveComponent("uni-list-item");(g+l+f)()}const x=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",b=()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js",k=()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js";Math||(x+b+k)();const F=e.defineComponent({__name:"Search",setup(g){const{$request:l}=e.getCurrentInstance().appContext.config.globalProperties,f=e.reactive({1:"#70c995",2:"#f7cc4f",3:"red"}),n=e.ref([]);e.onLoad(a=>{const t=e.index.getStorageSync("searchStorage");m.value=a.url?a.url:"FoodMessage",t?n.value=t:(e.index.setStorage({key:"searchStorage",data:[]}),n.value=[])});const r=e.ref(""),i=e.ref([]),d=e.ref(null),s=e.ref(!1),v=()=>{d.value!=null&&clearTimeout(d.value),d.value=setTimeout(async()=>{if(clearTimeout(d.value),r.value.length>0){const a=await l("/foods/getfoodbykey?key="+r.value,"GET");a.code==="200"&&(i.value=a.data,i.value!=null?s.value=!0:s.value=!1)}},2e3)},p=async a=>{r.value=a;const t=await l("/foods/getfoodbykey?key="+a,"GET");t.code==="200"&&(i.value=t.data,i.value!=null?s.value=!0:s.value=!1)},_=()=>{i.value=[],s.value=!1},m=e.ref("FoodMessage"),y=async a=>{const t=await l("/foods/food_message?foodId="+a,"GET");if(t.code=="200"){const o=t.data;n.value.indexOf(o.name)==-1&&(n.value.push(o.name),e.index.setStorage({key:"searchStorage",data:n.value.reverse()}));const c=await l("/collect/get_collect?foodId="+a,"GET");o.collect=c.data,m.value==="FoodMessage"?e.index.navigateTo({url:"../FoodMessage/FoodMessage",success:u=>{e.index.$emit("foodMessage",o),r.value="",_()}}):m.value==="FoodCompare"&&e.index.navigateBack({success:()=>{e.index.$emit("getFoodmessage",o)}})}},h=()=>{n.value=[],e.index.removeStorage({key:"searchStorage"})};return(a,t)=>e.e({a:e.o(v),b:e.p({type:"search",color:"#77b3f8",size:"30"}),c:e.o(v),d:e.o(v),e:e.o(_),f:e.o(o=>r.value=o),g:e.p({styles:"{height: 50px,border-radius: 25px,}",primaryColor:"#9c9c9c",trim:"true",inputBorder:!1,placeholder:"请输入食物名称",modelValue:r.value}),h:s.value},s.value?{i:e.f(i.value,(o,c,u)=>({a:"d2b35330-3-"+u+","+("d2b35330-2-"+u),b:e.p({type:"smallcircle-filled",size:"15",color:f[o.healthLevel]}),c:e.o(S=>y(o.foodId),c),d:"d2b35330-2-"+u,e:e.p({clickable:!0,title:o.name,note:o.calory+"千卡/100克",link:!0}),f:c}))}:{},{j:!s.value},s.value?{}:{k:e.p({type:"trash-filled",size:"18",color:"#6e6e6e;"}),l:e.o(h),m:e.f(n.value,(o,c,u)=>({a:e.t(o),b:c,c:e.o(S=>p(o),c)}))})}}),C=e._export_sfc(F,[["__file","/Users/xiaodu/前端/LoseFat/pageSearch/Search/Search.vue"]]);wx.createPage(C);
