"use strict";const e=require("../../common/vendor.js"),v=e.defineComponent({__name:"UpdataPhoneEnd",setup(h){const t=e.ref({phone:null,code:null}),{$request:u}=e.getCurrentInstance().appContext.config.globalProperties,l=n=>{var s=/[\t\r\f\n\s]*/g;return n.replace(s,"")},a=e.ref(!0),i=()=>{t.value.code.toString().length===4?a.value=!1:a.value=!0},r=e.ref("获取验证码"),c=e.ref(null),d=async()=>{let n=/^1[3-9]\d{9}$/;if(t.value.phone=l(t.value.phone),n.test(t.value.phone)){const s=await u("/user/getCode?phone="+t.value.phone,"POST");let o=61;s.code==="200"&&(c.value=setInterval(()=>{if(o==0){clearInterval(c.value),r.value="重新获取验证码";return}o-=1,r.value=o+"秒"},1e3))}else e.index.showToast({icon:"error",title:"手机号格式错误！"})},p=async()=>{const n=await u("/user/updatePhone","POST",t.value);n.code==="200"?(e.index.showToast({icon:"success",title:"更改成功！"}),e.index.setStorageSync("user",n.data),e.index.setStorageSync("token",n.data.token),e.index.redirectTo({url:"/pageHome/Account/Account"})):e.index.showToast({icon:"none",title:n.message})};return(n,s)=>({a:t.value.phone,b:e.o(o=>t.value.phone=o.detail.value),c:e.o([o=>t.value.code=o.detail.value,i]),d:t.value.code,e:e.t(r.value),f:e.o(d),g:e.o(p),h:e.n(a.value?"next-button-false":"next-button-true"),i:a.value})}}),g=e._export_sfc(v,[["__file","/Users/xiaodu/前端/LoseFat/pageHome/UpdataPhoneEnd/UpdataPhoneEnd.vue"]]);wx.createPage(g);
