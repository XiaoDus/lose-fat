"use strict";const t=require("../../common/vendor.js");Array||t.resolveComponent("uni-calendar")();const m=()=>"../../uni_modules/uni-calendar/components/uni-calendar/uni-calendar.js";Math||m();const p=t.defineComponent({__name:"WeightList",setup(u){const{$request:c}=t.getCurrentInstance().appContext.config.globalProperties,o=t.reactive({time:"",data:0}),r=t.ref(null),s=t.ref([]),d=async()=>{const e=await c("/user_weight_data","GET");e.code==="200"&&(r.value=e.data.reverse(),r.value.forEach(a=>{s.value.push({date:a.xAxisData,info:a.seriesData+"斤"})}))};t.onShow(()=>{d()});const l=()=>{const e=new Date,a=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate();return{fullDate:a+"-"+i+"-"+n,year:a,month:i,date:n,day:e.getDay()}},f=e=>{o.time=e.fulldate;const a=e.extraInfo.info?e.extraInfo.info.slice(0,-1):"",i=l().fullDate;Date.parse(e.fulldate)<=Date.parse(i)&&t.index.showModal({title:"提示",content:a,editable:!0,placeholderText:"请输入至多两位小数的体重",success:function(n){const g=/^\d+(\.\d{1,2})?$/;n.confirm&&(g.test(n.content)?(o.data=Number(n.content),c("/user_weight_data/add_weight","POST",o).then(_=>{_.code==="200"&&(h(o),t.index.showToast({icon:"success",title:"修改成功",duration:2e3}))})):t.index.showToast({icon:"error",title:"格式错误",duration:2e3}))}})},h=e=>{s.value.forEach(a=>{if(a.date===e.time)return a.info=e.data+"斤"}),s.value.push({date:e.time,info:e.data+"斤"})};return t.onPullDownRefresh(()=>{d(),setTimeout(()=>{t.index.stopPullDownRefresh()},2e3)}),(e,a)=>({a:t.o(f),b:t.p({["start-date"]:"2020-01-01",["end-date"]:"2029-12-31",insert:!0,selected:s.value})})}}),D=t._export_sfc(p,[["__file","/Users/xiaodu/前端/LoseFat/pageWeightList/WeightList/WeightList.vue"]]);wx.createPage(D);
